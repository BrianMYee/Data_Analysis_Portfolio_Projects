/* For this Data Analysis we will be using Data pulled from Zillow to compare Housing Prices in the state of North Carolina over the last 10 years by County.  We will also be looing at Rental prices and comparing the two.

I will be pulling the ZHVI Single-Family Homes Time Series ($) file by County from the Home Values section as well at the ZORI (Smoothed): All Homes Plus MultiFamily Time Series ($) by County from the Rentals section.

This data is located here: https://www.zillow.com/research/data/

I will be using SQLite on the DB Browser
*/

--Name Tables NC_SFH_County_Month and NC_County_Rental
*/ First let's explore the data a bit */

SELECT *
FROM NC_SFH_County_Month
WHERE Statename <> 'NC'

-- We have a lot of Data that we can ignore for out NC only Analysis.  Let's change that to a Delete statement and remove this data.

DELETE 
FROM NC_SFH_County_Month
WHERE Statename <> 'NC'

-- We should be left with only the NC Data (NC has 100 Counties, so you should be left with 100 rows of data.)

SELECT *
FROM NC_SFH_County_Month

--  Now let's follow the same process for the Rental information

SELECT *
FROM NC_County_Rental
WHERE Statename <> 'NC'

-- As before there is a lot of non NC data we can remove

DELETE
FROM NC_County_Rental
WHERE Statename <> 'NC'

-- The non NC data should be gone now

SELECT *
FROM NC_County_Rental

-- Only NC Data remains, but it looks like we have many less rows in this data.  
-- That's odd-  maybe Zillow does not track as many counties for Rental data as they do for single family homes.
-- To be sure, let's check the raw data and count the counties selected-  3079 vs 1068.
-- So we have confiremd that the Datasets do not match regarding counties-  
-- Maybe we should narrow our datasets to select counties since we cannot compare statewide data.

